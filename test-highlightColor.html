<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test highlightColor() Method</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .palette-swatch {
            width: 50px;
            height: 50px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            cursor: pointer;
            display: inline-block;
            margin: 5px;
            transition: all 0.2s ease;
        }
        .palette-swatch.active {
            border-color: #667eea;
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.2);
            transform: scale(1.1);
        }
        .palette-swatch:hover {
            transform: scale(1.15);
        }
        #clearHighlightBtn {
            display: none;
            margin: 10px 0;
            padding: 10px 20px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        .status {
            margin: 10px 0;
            padding: 10px;
            background: #f7fafc;
            border-radius: 5px;
        }
        .pass { color: green; font-weight: bold; }
        .fail { color: red; font-weight: bold; }
    </style>
</head>
<body>
    <h1>Test: highlightColor() Method</h1>
    <p>This test verifies the implementation of task 7.1</p>

    <div class="test-section">
        <h2>Test Setup</h2>
        <p>Click on color swatches to test highlighting functionality:</p>
        <div id="colorPaletteTop">
            <div class="palette-swatch" style="background-color: #ff0000;" data-color="#ff0000"></div>
            <div class="palette-swatch" style="background-color: #00ff00;" data-color="#00ff00"></div>
            <div class="palette-swatch" style="background-color: #0000ff;" data-color="#0000ff"></div>
            <div class="palette-swatch" style="background-color: #ffff00;" data-color="#ffff00"></div>
        </div>
        <button id="clearHighlightBtn">Clear Highlight (ESC)</button>
    </div>

    <div class="test-section">
        <h2>Test Results</h2>
        <div id="testResults"></div>
    </div>

    <div class="test-section">
        <h2>Manual Test Instructions</h2>
        <ol>
            <li><strong>Click a color swatch</strong> - Should add 'active' class and show clear button</li>
            <li><strong>Click the same swatch again</strong> - Should toggle off (remove active class, hide button)</li>
            <li><strong>Click a different swatch</strong> - Should move active class to new swatch</li>
            <li><strong>Click clear button</strong> - Should clear highlight</li>
            <li><strong>Press ESC key</strong> - Should clear highlight</li>
        </ol>
    </div>

    <script src="https://code.jquery.com/jquery-3.7.1.min.js" 
            integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" 
            crossorigin="anonymous"></script>
    <script src="app.js"></script>
    <script>
        // Wait for DOM to be ready
        $(document).ready(() => {
            const results = [];
            
            function addResult(test, passed, message) {
                const status = passed ? '<span class="pass">✓ PASS</span>' : '<span class="fail">✗ FAIL</span>';
                results.push(`<div class="status">${status} - ${test}: ${message}</div>`);
                $('#testResults').html(results.join(''));
            }

            // Create a mock app instance for testing
            const mockApp = new SVGColorAnalyzer();
            
            // Mock the createHighlightOverlay method since it's not implemented yet
            mockApp.createHighlightOverlay = function() {
                console.log('Mock createHighlightOverlay called');
            };

            // Test 1: Initial state
            addResult('Test 1', mockApp.selectedColor === null, 'Initial selectedColor should be null');

            // Test 2: Click first swatch
            const $firstSwatch = $('.palette-swatch').first();
            const firstColor = $firstSwatch.data('color');
            mockApp.highlightColor(firstColor, $firstSwatch);
            
            const test2Pass = mockApp.selectedColor === firstColor && 
                             $firstSwatch.hasClass('active') &&
                             $('#clearHighlightBtn').is(':visible');
            addResult('Test 2', test2Pass, 'First click should set selectedColor, add active class, and show clear button');

            // Test 3: Click same swatch (toggle off)
            mockApp.highlightColor(firstColor, $firstSwatch);
            
            const test3Pass = mockApp.selectedColor === null && 
                             !$firstSwatch.hasClass('active') &&
                             !$('#clearHighlightBtn').is(':visible');
            addResult('Test 3', test3Pass, 'Clicking same color should toggle off (clear highlight)');

            // Test 4: Click first swatch again, then click second swatch
            mockApp.highlightColor(firstColor, $firstSwatch);
            const $secondSwatch = $('.palette-swatch').eq(1);
            const secondColor = $secondSwatch.data('color');
            mockApp.highlightColor(secondColor, $secondSwatch);
            
            const test4Pass = mockApp.selectedColor === secondColor && 
                             !$firstSwatch.hasClass('active') &&
                             $secondSwatch.hasClass('active') &&
                             $('#clearHighlightBtn').is(':visible');
            addResult('Test 4', test4Pass, 'Clicking different color should move active class to new swatch');

            // Test 5: Clear highlight button
            $('#clearHighlightBtn').trigger('click');
            
            const test5Pass = mockApp.selectedColor === null && 
                             $('.palette-swatch.active').length === 0 &&
                             !$('#clearHighlightBtn').is(':visible');
            addResult('Test 5', test5Pass, 'Clear button should clear all highlighting');

            // Test 6: ESC key
            mockApp.highlightColor(firstColor, $firstSwatch);
            $(document).trigger($.Event('keydown', { key: 'Escape' }));
            
            const test6Pass = mockApp.selectedColor === null && 
                             $('.palette-swatch.active').length === 0;
            addResult('Test 6', test6Pass, 'ESC key should clear highlighting');

            console.log('All automated tests completed');
        });
    </script>
</body>
</html>
